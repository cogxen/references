<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <link rel="shortcut icon" href="/src/img/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="/src/styles/jp.css" />
    <title>Activity | Aggregating</title>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.1.10/require.min.js"
      defer
    ></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS_CHTML-full,Safe"
      defer
    ></script>
    <script type="text/x-mathjax-config" defer>
      init_mathjax = function() {
          if (window.MathJax) {
          // MathJax loaded
              MathJax.Hub.Config({
                  TeX: {
                      equationNumbers: {
                      autoNumber: "AMS",
                      useLabelIds: true
                      }
                  },
                  tex2jax: {
                      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                      processEscapes: true,
                      processEnvironments: true
                  },
                  displayAlign: 'center',
                  CommonHTML: {
                      linebreaks: {
                      automatic: true
                      }
                  }
              });

              MathJax.Hub.Queue(["Typeset", MathJax.Hub]);
          }
      }
      init_mathjax();
    </script>
    <script type="module" defer>
      document.addEventListener("DOMContentLoaded", async () => {
        const diagrams = document.querySelectorAll(".jp-Mermaid > pre.mermaid")
        // do not load mermaidjs if not needed
        if (!diagrams.length) {
          return
        }
        const mermaid = (
          await import("https://cdnjs.cloudflare.com/ajax/libs/mermaid/10.3.1/mermaid.esm.min.mjs")
        ).default
        const parser = new DOMParser()

        mermaid.initialize({
          maxTextSize: 100000,
          startOnLoad: false,
          fontFamily: window
            .getComputedStyle(document.body)
            .getPropertyValue("--jp-ui-font-family"),
          theme: document.querySelector("body[data-jp-theme-light='true']") ? "default" : "dark",
        })

        let _nextMermaidId = 0

        function makeMermaidImage(svg) {
          const img = document.createElement("img")
          const doc = parser.parseFromString(svg, "image/svg+xml")
          const svgEl = doc.querySelector("svg")
          const { maxWidth } = svgEl?.style || {}
          const firstTitle = doc.querySelector("title")
          const firstDesc = doc.querySelector("desc")

          img.setAttribute("src", `data:image/svg+xml,${encodeURIComponent(svg)}`)
          if (maxWidth) {
            img.width = parseInt(maxWidth)
          }
          if (firstTitle) {
            img.setAttribute("alt", firstTitle.textContent)
          }
          if (firstDesc) {
            const caption = document.createElement("figcaption")
            caption.className = "sr-only"
            caption.textContent = firstDesc.textContent
            return [img, caption]
          }
          return [img]
        }

        async function makeMermaidError(text) {
          let errorMessage = ""
          try {
            await mermaid.parse(text)
          } catch (err) {
            errorMessage = `${err}`
          }

          const result = document.createElement("details")
          result.className = "jp-RenderedMermaid-Details"
          const summary = document.createElement("summary")
          summary.className = "jp-RenderedMermaid-Summary"
          const pre = document.createElement("pre")
          const code = document.createElement("code")
          code.innerText = text
          pre.appendChild(code)
          summary.appendChild(pre)
          result.appendChild(summary)

          const warning = document.createElement("pre")
          warning.innerText = errorMessage
          result.appendChild(warning)
          return [result]
        }

        async function renderOneMarmaid(src) {
          const id = `jp-mermaid-${_nextMermaidId++}`
          const parent = src.parentNode
          let raw = src.textContent.trim()
          const el = document.createElement("div")
          el.style.visibility = "hidden"
          document.body.appendChild(el)
          let results = null
          let output = null
          try {
            const { svg } = await mermaid.render(id, raw, el)
            results = makeMermaidImage(svg)
            output = document.createElement("figure")
            results.map(output.appendChild, output)
          } catch (err) {
            parent.classList.add("jp-mod-warning")
            results = await makeMermaidError(raw)
            output = results[0]
          } finally {
            el.remove()
          }
          parent.classList.add("jp-RenderedMermaid")
          parent.appendChild(output)
        }

        void Promise.all([...diagrams].map(renderOneMarmaid))
      })
    </script>
  </head>
  <body class="jp-Notebook" data-jp-theme-light="true" data-jp-theme-name="JupyterLab Light">
    <main>
      <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [1]:</div>
            <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
              <div class="cm-editor cm-s-jupyter">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">results</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;results.csv&#39;</span><span class="p">)</span>
<span class="n">results</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="jp-Cell-outputWrapper">
          <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"></div>
          <div class="jp-OutputArea jp-Cell-outputArea">
            <div class="jp-OutputArea-child jp-OutputArea-executeResult">
              <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[1]:</div>
              <div
                class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
                data-mime-type="text/html"
                tabindex="0"
              >
                <div>
                  <style scoped="">
                    .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                    }

                    .dataframe tbody tr th {
                      vertical-align: top;
                    }

                    .dataframe thead th {
                      text-align: right;
                    }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right">
                        <th></th>
                        <th>date</th>
                        <th>year</th>
                        <th>home_team</th>
                        <th>away_team</th>
                        <th>home_score</th>
                        <th>away_score</th>
                        <th>total_goals</th>
                        <th>win_margin</th>
                        <th>tournament</th>
                        <th>city</th>
                        <th>country</th>
                        <th>neutral</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>2000-01-04</td>
                        <td>2000</td>
                        <td>Egypt</td>
                        <td>Togo</td>
                        <td>2</td>
                        <td>1</td>
                        <td>3</td>
                        <td>1</td>
                        <td>Friendly</td>
                        <td>Aswan</td>
                        <td>Egypt</td>
                        <td>False</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>2000-01-07</td>
                        <td>2000</td>
                        <td>Tunisia</td>
                        <td>Togo</td>
                        <td>7</td>
                        <td>0</td>
                        <td>7</td>
                        <td>7</td>
                        <td>Friendly</td>
                        <td>Tunis</td>
                        <td>Tunisia</td>
                        <td>False</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>2000-01-08</td>
                        <td>2000</td>
                        <td>Trinidad and Tobago</td>
                        <td>Canada</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>0</td>
                        <td>Friendly</td>
                        <td>Port of Spain</td>
                        <td>Trinidad and Tobago</td>
                        <td>False</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>2000-01-09</td>
                        <td>2000</td>
                        <td>Burkina Faso</td>
                        <td>Gabon</td>
                        <td>1</td>
                        <td>1</td>
                        <td>2</td>
                        <td>0</td>
                        <td>Friendly</td>
                        <td>Ouagadougou</td>
                        <td>Burkina Faso</td>
                        <td>False</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>2000-01-09</td>
                        <td>2000</td>
                        <td>Guatemala</td>
                        <td>Armenia</td>
                        <td>1</td>
                        <td>1</td>
                        <td>2</td>
                        <td>0</td>
                        <td>Friendly</td>
                        <td>Los Angeles</td>
                        <td>United States</td>
                        <td>True</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt"></div>
            <div
              class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
              data-mime-type="text/markdown"
            >
              <h4 id="1.-Count-the-Number-of-Unique-Home-Teams-and-Away-Teams">
                1. Count the Number of Unique Home Teams and Away Teams<a
                  class="anchor-link"
                  href="#1.-Count-the-Number-of-Unique-Home-Teams-and-Away-Teams"
                  >Â¶</a
                >
              </h4>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [2]:</div>
            <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
              <div class="cm-editor cm-s-jupyter">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">unique_num_home</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;home_team&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>
<span class="n">unique_num_away</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="s1">&#39;home_team&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">nunique</span><span class="p">()</span>

<span class="n">unique_num_home</span><span class="p">,</span> <span class="n">unique_num_away</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="jp-Cell-outputWrapper">
          <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"></div>
          <div class="jp-OutputArea jp-Cell-outputArea">
            <div class="jp-OutputArea-child jp-OutputArea-executeResult">
              <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[2]:</div>
              <div
                class="jp-RenderedText jp-OutputArea-output jp-OutputArea-executeResult"
                data-mime-type="text/plain"
                tabindex="0"
              >
                <pre>(245, 245)</pre>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt"></div>
            <div
              class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
              data-mime-type="text/markdown"
            >
              <h4 id="2.-Tournament-Statistics">
                2. Tournament Statistics<a class="anchor-link" href="#2.-Tournament-Statistics"
                  >Â¶</a
                >
              </h4>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt"></div>
            <div
              class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
              data-mime-type="text/markdown"
            >
              <p>For each tournament</p>
              <ul>
                <li>Compute the number of games played</li>
                <li>Sum up the total number of goals</li>
                <li>Obtain the maximum and minimum win margins</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [3]:</div>
            <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
              <div class="cm-editor cm-s-jupyter">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="n">tournament_stats</span> <span class="o">=</span> <span class="n">results</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;tournament&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span>
    <span class="s1">&#39;date&#39;</span><span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span>
    <span class="s1">&#39;total_goals&#39;</span><span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">,</span>
    <span class="s1">&#39;win_margin&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;max&#39;</span><span class="p">,</span> <span class="s1">&#39;min&#39;</span><span class="p">]</span>
<span class="p">})</span>

<span class="n">tournament_stats</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="jp-Cell-outputWrapper">
          <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"></div>
          <div class="jp-OutputArea jp-Cell-outputArea">
            <div class="jp-OutputArea-child jp-OutputArea-executeResult">
              <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[3]:</div>
              <div
                class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
                data-mime-type="text/html"
                tabindex="0"
              >
                <div>
                  <style scoped="">
                    .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                    }

                    .dataframe tbody tr th {
                      vertical-align: top;
                    }

                    .dataframe thead tr th {
                      text-align: left;
                    }

                    .dataframe thead tr:last-of-type th {
                      text-align: right;
                    }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr>
                        <th></th>
                        <th>date</th>
                        <th>total_goals</th>
                        <th colspan="2" halign="left">win_margin</th>
                      </tr>
                      <tr>
                        <th></th>
                        <th>count</th>
                        <th>sum</th>
                        <th>max</th>
                        <th>min</th>
                      </tr>
                      <tr>
                        <th>tournament</th>
                        <th></th>
                        <th></th>
                        <th></th>
                        <th></th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>AFC Asian Cup qualification</th>
                        <td>465</td>
                        <td>1480</td>
                        <td>20</td>
                        <td>-8</td>
                      </tr>
                      <tr>
                        <th>African Cup of Nations</th>
                        <td>421</td>
                        <td>933</td>
                        <td>5</td>
                        <td>-5</td>
                      </tr>
                      <tr>
                        <th>African Cup of Nations qualification</th>
                        <td>1012</td>
                        <td>2388</td>
                        <td>7</td>
                        <td>-10</td>
                      </tr>
                      <tr>
                        <th>CECAFA Cup</th>
                        <td>341</td>
                        <td>858</td>
                        <td>9</td>
                        <td>-9</td>
                      </tr>
                      <tr>
                        <th>FIFA World Cup</th>
                        <td>384</td>
                        <td>965</td>
                        <td>8</td>
                        <td>-6</td>
                      </tr>
                      <tr>
                        <th>FIFA World Cup qualification</th>
                        <td>4942</td>
                        <td>14174</td>
                        <td>31</td>
                        <td>-12</td>
                      </tr>
                      <tr>
                        <th>Friendly</th>
                        <td>7472</td>
                        <td>18853</td>
                        <td>15</td>
                        <td>-9</td>
                      </tr>
                      <tr>
                        <th>Gold Cup</th>
                        <td>297</td>
                        <td>796</td>
                        <td>7</td>
                        <td>-6</td>
                      </tr>
                      <tr>
                        <th>UEFA Euro qualification</th>
                        <td>1293</td>
                        <td>3593</td>
                        <td>11</td>
                        <td>-13</td>
                      </tr>
                      <tr>
                        <th>UEFA Nations League</th>
                        <td>468</td>
                        <td>1139</td>
                        <td>6</td>
                        <td>-6</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt"></div>
            <div
              class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
              data-mime-type="text/markdown"
            >
              <h4 id="3.-Analyzing-the-2022-FIFA-World-Cup">
                3. Analyzing the 2022 FIFA World Cup<a
                  class="anchor-link"
                  href="#3.-Analyzing-the-2022-FIFA-World-Cup"
                  >Â¶</a
                >
              </h4>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt"></div>
            <div
              class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
              data-mime-type="text/markdown"
            >
              <p>Calculate the Total Number of Goals by Each Team in the FIFA World Cup 2022.</p>
              <p>
                Hint: We&#39;ll need to combine each team&#39;s goals scored as both the home team
                and away team.
              </p>
              <ol>
                <li>
                  <strong>Split</strong> <code>results</code> into a DataFrame containing only FIFA
                  World Cup 2022 matches
                </li>
              </ol>
              <ul>
                <li>
                  <p>Combine multiple boolean masks using the <code>&amp;</code> operator:</p>
                  <ul>
                    <li><code>results[&#39;tournament&#39;]==&#39;FIFA World Cup&#39;</code></li>
                    <li><code>results[&#39;year&#39;]== 2022</code></li>
                  </ul>
                </li>
                <li>
                  <p>
                    Perform a second split that creates separate DataFrames for home teams and away
                    teams
                  </p>
                </li>
              </ul>
              <ol start="2">
                <li>
                  <strong>Apply</strong> aggregation functions to each DataFrame that sums up the
                  total number of goals scored by each team
                </li>
              </ol>
              <ul>
                <li>
                  Don&#39;t forget to flatten the index of the resulting aggregated DataFrames
                </li>
              </ul>
              <ol start="3">
                <li>
                  <strong>Combine</strong> the two DataFrames by performing a
                  <strong>left</strong> join where the DataFrame on the left contains the data for
                  the home team (important!)
                </li>
              </ol>
              <ul>
                <li>
                  Feel free to clean the column names
                  <strong
                    >but don&#39;t drop the <code>home_team</code> and
                    <code>away_team</code> columns!</strong
                  >
                </li>
                <li>
                  Create a new column <code>total_goals</code> that adds up the total goals scored
                  by each team as the home team and away team
                </li>
                <li>
                  Sort from highest to lowest number of <code>total_goals</code> by each team.
                </li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [4]:</div>
            <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
              <div class="cm-editor cm-s-jupyter">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># SPLIT</span>

<span class="c1"># 1. Create a filter mask</span>
<span class="n">fwc_2022_matches</span> <span class="o">=</span> <span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;tournament&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;FIFA World Cup&#39;</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">2022</span><span class="p">)</span>

<span class="c1"># 2. Apply the mask</span>
<span class="n">fwc_2022_df</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="n">fwc_2022_matches</span><span class="p">]</span>

<span class="c1"># 3. Display the new DataFrame</span>
<span class="n">fwc_2022_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="jp-Cell-outputWrapper">
          <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"></div>
          <div class="jp-OutputArea jp-Cell-outputArea">
            <div class="jp-OutputArea-child jp-OutputArea-executeResult">
              <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[4]:</div>
              <div
                class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
                data-mime-type="text/html"
                tabindex="0"
              >
                <div>
                  <style scoped="">
                    .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                    }

                    .dataframe tbody tr th {
                      vertical-align: top;
                    }

                    .dataframe thead th {
                      text-align: right;
                    }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right">
                        <th></th>
                        <th>date</th>
                        <th>year</th>
                        <th>home_team</th>
                        <th>away_team</th>
                        <th>home_score</th>
                        <th>away_score</th>
                        <th>total_goals</th>
                        <th>win_margin</th>
                        <th>tournament</th>
                        <th>city</th>
                        <th>country</th>
                        <th>neutral</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>17021</th>
                        <td>2022-11-20</td>
                        <td>2022</td>
                        <td>Qatar</td>
                        <td>Ecuador</td>
                        <td>0</td>
                        <td>2</td>
                        <td>2</td>
                        <td>-2</td>
                        <td>FIFA World Cup</td>
                        <td>Al Khor</td>
                        <td>Qatar</td>
                        <td>False</td>
                      </tr>
                      <tr>
                        <th>17022</th>
                        <td>2022-11-21</td>
                        <td>2022</td>
                        <td>Senegal</td>
                        <td>Netherlands</td>
                        <td>0</td>
                        <td>2</td>
                        <td>2</td>
                        <td>-2</td>
                        <td>FIFA World Cup</td>
                        <td>Doha</td>
                        <td>Qatar</td>
                        <td>True</td>
                      </tr>
                      <tr>
                        <th>17023</th>
                        <td>2022-11-21</td>
                        <td>2022</td>
                        <td>England</td>
                        <td>Iran</td>
                        <td>6</td>
                        <td>2</td>
                        <td>8</td>
                        <td>4</td>
                        <td>FIFA World Cup</td>
                        <td>Al Rayyan</td>
                        <td>Qatar</td>
                        <td>True</td>
                      </tr>
                      <tr>
                        <th>17024</th>
                        <td>2022-11-21</td>
                        <td>2022</td>
                        <td>United States</td>
                        <td>Wales</td>
                        <td>1</td>
                        <td>1</td>
                        <td>2</td>
                        <td>0</td>
                        <td>FIFA World Cup</td>
                        <td>Al Rayyan</td>
                        <td>Qatar</td>
                        <td>True</td>
                      </tr>
                      <tr>
                        <th>17025</th>
                        <td>2022-11-22</td>
                        <td>2022</td>
                        <td>Argentina</td>
                        <td>Saudi Arabia</td>
                        <td>1</td>
                        <td>2</td>
                        <td>3</td>
                        <td>-1</td>
                        <td>FIFA World Cup</td>
                        <td>Lusail</td>
                        <td>Qatar</td>
                        <td>True</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [5]:</div>
            <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
              <div class="cm-editor cm-s-jupyter">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># APPLY</span>

<span class="c1"># 1. Use filter mask and create split DataFrame for home and away teams</span>
<span class="c1"># - For home_teams</span>
<span class="n">home_goals</span> <span class="o">=</span> <span class="n">fwc_2022_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;home_team&#39;</span><span class="p">)[</span><span class="s1">&#39;home_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;home_goals&#39;</span><span class="p">)</span>
<span class="n">home_goals</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="jp-Cell-outputWrapper">
          <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"></div>
          <div class="jp-OutputArea jp-Cell-outputArea">
            <div class="jp-OutputArea-child jp-OutputArea-executeResult">
              <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[5]:</div>
              <div
                class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
                data-mime-type="text/html"
                tabindex="0"
              >
                <div>
                  <style scoped="">
                    .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                    }

                    .dataframe tbody tr th {
                      vertical-align: top;
                    }

                    .dataframe thead th {
                      text-align: right;
                    }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right">
                        <th></th>
                        <th>home_team</th>
                        <th>home_goals</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>Argentina</td>
                        <td>11</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>Australia</td>
                        <td>1</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>Belgium</td>
                        <td>1</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>Brazil</td>
                        <td>7</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>Cameroon</td>
                        <td>4</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [6]:</div>
            <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
              <div class="cm-editor cm-s-jupyter">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># - For away_teams</span>
<span class="n">away_goals</span> <span class="o">=</span> <span class="n">fwc_2022_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;away_team&#39;</span><span class="p">)[</span><span class="s1">&#39;away_score&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;away_goals&#39;</span><span class="p">)</span>
<span class="n">away_goals</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="jp-Cell-outputWrapper">
          <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"></div>
          <div class="jp-OutputArea jp-Cell-outputArea">
            <div class="jp-OutputArea-child jp-OutputArea-executeResult">
              <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[6]:</div>
              <div
                class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
                data-mime-type="text/html"
                tabindex="0"
              >
                <div>
                  <style scoped="">
                    .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                    }

                    .dataframe tbody tr th {
                      vertical-align: top;
                    }

                    .dataframe thead th {
                      text-align: right;
                    }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right">
                        <th></th>
                        <th>away_team</th>
                        <th>away_goals</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>0</th>
                        <td>Argentina</td>
                        <td>4</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>Australia</td>
                        <td>3</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>Belgium</td>
                        <td>0</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>Brazil</td>
                        <td>1</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>Cameroon</td>
                        <td>0</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-CodeCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt">InÂ [7]:</div>
            <div class="jp-CodeMirrorEditor jp-Editor jp-InputArea-editor" data-type="inline">
              <div class="cm-editor cm-s-jupyter">
                <div class="highlight hl-ipython3">
                  <pre><span></span><span class="c1"># COMBINE</span>

<span class="c1"># 1. Rename &#39;away_team&#39; and &#39;away_goals&#39; in away_goals DataFrame to match home_goals DataFrame</span>
<span class="n">away_goals</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;away_team&#39;</span><span class="p">:</span> <span class="s1">&#39;team&#39;</span><span class="p">,</span> <span class="s1">&#39;away_goals&#39;</span><span class="p">:</span> <span class="s1">&#39;away_goals&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">home_goals</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span>
    <span class="s1">&#39;home_team&#39;</span><span class="p">:</span> <span class="s1">&#39;team&#39;</span><span class="p">,</span> <span class="s1">&#39;home_goals&#39;</span><span class="p">:</span> <span class="s1">&#39;home_goals&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 2. Perform a `left` join</span>
<span class="n">combined_goals</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">home_goals</span><span class="p">,</span> <span class="n">away_goals</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;team&#39;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">)</span>

<span class="c1"># 3. Fill `NaN` with 0 for teams that didn&#39;t score away goals</span>
<span class="n">combined_goals</span><span class="p">[</span><span class="s1">&#39;away_goals&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># 4. Create new column for &#39;total_goals&#39;</span>
<span class="n">combined_goals</span><span class="p">[</span><span class="s1">&#39;total_goals&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">combined_goals</span><span class="p">[</span><span class="s1">&#39;home_goals&#39;</span><span class="p">]</span>  <span class="o">+</span> <span class="n">combined_goals</span><span class="p">[</span><span class="s1">&#39;away_goals&#39;</span><span class="p">]</span>

<span class="c1"># 5. Sort DataFrame by &#39;total_goals&#39; in descending order</span>
<span class="n">combined_goals</span> <span class="o">=</span> <span class="n">combined_goals</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s1">&#39;total_goals&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="c1">#  6. Display the new DataFrame</span>
<span class="n">combined_goals</span>
</pre>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="jp-Cell-outputWrapper">
          <div class="jp-Collapser jp-OutputCollapser jp-Cell-outputCollapser"></div>
          <div class="jp-OutputArea jp-Cell-outputArea">
            <div class="jp-OutputArea-child jp-OutputArea-executeResult">
              <div class="jp-OutputPrompt jp-OutputArea-prompt">Out[7]:</div>
              <div
                class="jp-RenderedHTMLCommon jp-RenderedHTML jp-OutputArea-output jp-OutputArea-executeResult"
                data-mime-type="text/html"
                tabindex="0"
              >
                <div>
                  <style scoped="">
                    .dataframe tbody tr th:only-of-type {
                      vertical-align: middle;
                    }

                    .dataframe tbody tr th {
                      vertical-align: top;
                    }

                    .dataframe thead th {
                      text-align: right;
                    }
                  </style>
                  <table border="1" class="dataframe">
                    <thead>
                      <tr style="text-align: right">
                        <th></th>
                        <th>team</th>
                        <th>home_goals</th>
                        <th>away_goals</th>
                        <th>total_goals</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>11</th>
                        <td>France</td>
                        <td>11</td>
                        <td>5.0</td>
                        <td>16.0</td>
                      </tr>
                      <tr>
                        <th>0</th>
                        <td>Argentina</td>
                        <td>11</td>
                        <td>4.0</td>
                        <td>15.0</td>
                      </tr>
                      <tr>
                        <th>10</th>
                        <td>England</td>
                        <td>10</td>
                        <td>3.0</td>
                        <td>13.0</td>
                      </tr>
                      <tr>
                        <th>20</th>
                        <td>Portugal</td>
                        <td>11</td>
                        <td>1.0</td>
                        <td>12.0</td>
                      </tr>
                      <tr>
                        <th>18</th>
                        <td>Netherlands</td>
                        <td>6</td>
                        <td>4.0</td>
                        <td>10.0</td>
                      </tr>
                      <tr>
                        <th>26</th>
                        <td>Spain</td>
                        <td>8</td>
                        <td>1.0</td>
                        <td>9.0</td>
                      </tr>
                      <tr>
                        <th>3</th>
                        <td>Brazil</td>
                        <td>7</td>
                        <td>1.0</td>
                        <td>8.0</td>
                      </tr>
                      <tr>
                        <th>7</th>
                        <td>Croatia</td>
                        <td>7</td>
                        <td>1.0</td>
                        <td>8.0</td>
                      </tr>
                      <tr>
                        <th>17</th>
                        <td>Morocco</td>
                        <td>1</td>
                        <td>5.0</td>
                        <td>6.0</td>
                      </tr>
                      <tr>
                        <th>12</th>
                        <td>Germany</td>
                        <td>1</td>
                        <td>5.0</td>
                        <td>6.0</td>
                      </tr>
                      <tr>
                        <th>27</th>
                        <td>Switzerland</td>
                        <td>1</td>
                        <td>4.0</td>
                        <td>5.0</td>
                      </tr>
                      <tr>
                        <th>25</th>
                        <td>South Korea</td>
                        <td>4</td>
                        <td>1.0</td>
                        <td>5.0</td>
                      </tr>
                      <tr>
                        <th>13</th>
                        <td>Ghana</td>
                        <td>0</td>
                        <td>5.0</td>
                        <td>5.0</td>
                      </tr>
                      <tr>
                        <th>15</th>
                        <td>Japan</td>
                        <td>3</td>
                        <td>2.0</td>
                        <td>5.0</td>
                      </tr>
                      <tr>
                        <th>23</th>
                        <td>Senegal</td>
                        <td>0</td>
                        <td>5.0</td>
                        <td>5.0</td>
                      </tr>
                      <tr>
                        <th>24</th>
                        <td>Serbia</td>
                        <td>2</td>
                        <td>3.0</td>
                        <td>5.0</td>
                      </tr>
                      <tr>
                        <th>9</th>
                        <td>Ecuador</td>
                        <td>1</td>
                        <td>3.0</td>
                        <td>4.0</td>
                      </tr>
                      <tr>
                        <th>14</th>
                        <td>Iran</td>
                        <td>0</td>
                        <td>4.0</td>
                        <td>4.0</td>
                      </tr>
                      <tr>
                        <th>1</th>
                        <td>Australia</td>
                        <td>1</td>
                        <td>3.0</td>
                        <td>4.0</td>
                      </tr>
                      <tr>
                        <th>4</th>
                        <td>Cameroon</td>
                        <td>4</td>
                        <td>0.0</td>
                        <td>4.0</td>
                      </tr>
                      <tr>
                        <th>6</th>
                        <td>Costa Rica</td>
                        <td>2</td>
                        <td>1.0</td>
                        <td>3.0</td>
                      </tr>
                      <tr>
                        <th>29</th>
                        <td>United States</td>
                        <td>1</td>
                        <td>2.0</td>
                        <td>3.0</td>
                      </tr>
                      <tr>
                        <th>19</th>
                        <td>Poland</td>
                        <td>2</td>
                        <td>1.0</td>
                        <td>3.0</td>
                      </tr>
                      <tr>
                        <th>22</th>
                        <td>Saudi Arabia</td>
                        <td>1</td>
                        <td>2.0</td>
                        <td>3.0</td>
                      </tr>
                      <tr>
                        <th>30</th>
                        <td>Uruguay</td>
                        <td>0</td>
                        <td>2.0</td>
                        <td>2.0</td>
                      </tr>
                      <tr>
                        <th>16</th>
                        <td>Mexico</td>
                        <td>0</td>
                        <td>2.0</td>
                        <td>2.0</td>
                      </tr>
                      <tr>
                        <th>5</th>
                        <td>Canada</td>
                        <td>1</td>
                        <td>1.0</td>
                        <td>2.0</td>
                      </tr>
                      <tr>
                        <th>21</th>
                        <td>Qatar</td>
                        <td>1</td>
                        <td>0.0</td>
                        <td>1.0</td>
                      </tr>
                      <tr>
                        <th>8</th>
                        <td>Denmark</td>
                        <td>0</td>
                        <td>1.0</td>
                        <td>1.0</td>
                      </tr>
                      <tr>
                        <th>28</th>
                        <td>Tunisia</td>
                        <td>1</td>
                        <td>0.0</td>
                        <td>1.0</td>
                      </tr>
                      <tr>
                        <th>2</th>
                        <td>Belgium</td>
                        <td>1</td>
                        <td>0.0</td>
                        <td>1.0</td>
                      </tr>
                      <tr>
                        <th>31</th>
                        <td>Wales</td>
                        <td>0</td>
                        <td>1.0</td>
                        <td>1.0</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="jp-Cell jp-MarkdownCell jp-Notebook-cell">
        <div class="jp-Cell-inputWrapper" tabindex="0">
          <div class="jp-Collapser jp-InputCollapser jp-Cell-inputCollapser"></div>
          <div class="jp-InputArea jp-Cell-inputArea">
            <div class="jp-InputPrompt jp-InputArea-prompt"></div>
            <div
              class="jp-RenderedHTMLCommon jp-RenderedMarkdown jp-MarkdownOutput"
              data-mime-type="text/markdown"
            >
              <p>
                Note: Since the world cup in 2022 took place in Qatar, they never played as the away
                team! This is why we used the <strong>left</strong> join in order to return
                Qatar&#39;s total home goals!
              </p>
            </div>
          </div>
        </div>
      </div>
    </main>

    <script type="text/javascript" src="/relay.js"></script>
  </body>
</html>
